{
  "title": "Paper_427",
  "abstract": "pmc Natl Sci Rev Natl Sci Rev 4044 nsr nsr National Science Review 2095-5138 2053-714X Oxford University Press PMC12485608 PMC12485608.1 12485608 12485608 41040483 10.1093/nsr/nwaf255 nwaf255 1 Research Article Molecular Biology & Genetics Nsr/8 AcademicSubjects/MED00010 AcademicSubjects/SCI00010 Cell-GraphCompass: modeling single cells with graph structure foundation model Fang Chen Conceptualization Data curation Formal analysis Investigation Methodology Software Validation Visualization Writing - original draft Writing - review & editing  School of Advanced Interdisciplinary Sciences, University of Chinese Academy of Sciences Beijing 100049 China  State Key Laboratory of Organ Regeneration and Reconstruction, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  Beijing Institute for Stem Cell and Regenerative Medicine Beijing 100101 China  Computer Network Information Center, Chinese Academy of Sciences Beijing 100083 China  iFLYTEK Research Hefei 230088 China https://orcid.org/0000-0002-1404-3971 Cui Wentao Methodology Validation Visualization Writing - review & editing  Computer Network Information Center, Chinese Academy of Sciences Beijing 100083 China  University of Chinese Academy of Sciences Beijing 100049 China Hu Zhilong Conceptualization Data curation Formal analysis Investigation Methodology Software Validation Visualization  Computer Network Information Center, Chinese Academy of Sciences Beijing 100083 China  iFLYTEK Research Hefei 230088 China  University of Chinese Academy of Sciences Beijing 100049 China Liu Wenhao Data curation Validation Visualization  State Key Laboratory of Organ Regeneration and Reconstruction, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  Beijing Institute for Stem Cell and Regenerative Medicine Beijing 100101 China Chen Shubai Validation  Institute of Computing Technology, Chinese Academy of Sciences Beijing 100190 China  University of Chinese Academy of Sciences Beijing 100049 China Chang Shaole Software Validation  iFLYTEK Research Hefei 230088 China Long Qingqing Data curation Writing - original draft Writing - review & editing  Computer Network Information Center, Chinese Academy of Sciences Beijing 100083 China  University of Chinese Academy of Sciences Beijing 100049 China Li Cong Validation  State Key Laboratory of Organ Regeneration and Reconstruction, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  Beijing Institute for Stem Cell and Regenerative Medicine Beijing 100101 China  University of Chinese Academy of Sciences Beijing 100049 China Liu Yana Data curation  State Key Laboratory of Organ Regeneration and Reconstruction, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  Beijing Institute for Stem Cell and Regenerative Medicine Beijing 100101 China Jiang Haiping Data curation  State Key Laboratory of Organ Regeneration and Reconstruction, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  Beijing Institute for Stem Cell and Regenerative Medicine Beijing 100101 China Wang Pengfei Project administration Supervision  Computer Network Information Center, Chinese Academy of Sciences Beijing 100083 China  University of Chinese Academy of Sciences Beijing 100049 China Pan Jia Conceptualization Project administration  iFLYTEK Research Hefei 230088 China Hu Guoping Project administration Resources Supervision  iFLYTEK Research Hefei 230088 China Liu Guole Conceptualization Project administration Supervision  State Key Laboratory of Organ Regeneration and Reconstruction, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  Beijing Institute for Stem Cell and Regenerative Medicine Beijing 100101 China  Human Organ Physiopathology Emulation System, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  University of Chinese Academy of Sciences Beijing 100049 China Meng Zhen Project administration Supervision  Computer Network Information Center, Chinese Academy of Sciences Beijing 100083 China  University of Chinese Academy of Sciences Beijing 100049 China Zhou Yuanchun Data curation Funding acquisition Project administration Resources Supervision Writing - original draft Writing - review & editing  School of Advanced Interdisciplinary Sciences, University of Chinese Academy of Sciences Beijing 100049 China  Computer Network Information Center, Chinese Academy of Sciences Beijing 100083 China Chen Linghui Conceptualization Formal analysis Methodology Project administration Supervision Writing - original draft Writing - review & editing  Oristruct Biotech Co., Ltd Hefei 230026 China Feng Guihai  State Key Laboratory of Organ Regeneration and Reconstruction, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  Beijing Institute for Stem Cell and Regenerative Medicine Beijing 100101 China  Human Organ Physiopathology Emulation System, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  University of Chinese Academy of Sciences Beijing 100049 China Li Xin Conceptualization Data curation Formal analysis Funding acquisition Investigation Methodology Project administration Resources Supervision Writing - original draft Writing - review & editing  School of Advanced Interdisciplinary Sciences, University of Chinese Academy of Sciences Beijing 100049 China  State Key Laboratory of Organ Regeneration and Reconstruction, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China  Beijing Institute for Stem Cell and Regenerative Medicine Beijing 100101 China  Human Organ Physiopathology Emulation System, Institute of Zoology, Chinese Academy of Sciences Beijing 100101 China Corresponding authors xinli@ioz.ac.cn Corresponding authors fenggh@ioz.ac.cn Corresponding authors lhchen@iflytek.com Corresponding authors zyc@cnic.cn Corresponding authors zhenm99@cnic.cn Chen Fang, Wentao Cui, Zhilong Hu and Wenhao Liu Equally contributed to this work. 10 2025 24 6 2025 12 10 496565 nwaf255 25 2 2025 28 4 2025 09 6 2025 01 10 2025 24 06 2025 02 10 2025 03 10 2025 © The Author(s) 2025. Published by Oxford University Press on behalf of China Science Publishing & Media Ltd. 2025 https://creativecommons.org/licenses/by/4.0/ This is an Open Access article distributed under the terms of the Creative Commons Attribution License ( https://creativecommons.org/licenses/by/4.0/ ABSTRACT Cells in the human body are regulated by sophisticated networks of gene regulation, which allows them to fulfill their cellular destiny and function. Inspired by the advancements in large language models, there have been several attempts focusing on constructing foundation models with single-cell transcriptomic data to decipher gene regulatory networks. However, these models tend to impose a sequential structure on genes within each cell, which may omit intrinsic biological characteristics and lack the utilization of other available prior knowledge. In this paper, we introduce Cell-GraphCompass (CGCompass), the pioneering foundation model that employs graph pre-training to model genes and cells. We use three types of gene-related information as node features for constructing cell graphs and collect data from three perspectives depicting relationships between genes as edge features. We pre-trained the model with over 50 million human cells and then fine-tuned it to a broad spectrum of tasks, such as batch integration, cell type annotation, single-cell gene perturbation and in silico single-cell transcriptomics foundation model pre-training graph neural network knowledge embedding National Key Research and Development Program 10.13039/501100012166 2024YFF0729200 CAS Project for Young Scientists in Basic Research YSBR-076 Pilot Project for Enhancing Original Innovation Capability of the Chinese Academy of Sciences E129L111 Informatization Plan of the Chinese Academy of Sciences CAS-WX2021SF-0101 Strategic Priority Research Program of the Chinese Academy of Sciences XDB38030300 National Natural Science Foundation of China 10.13039/501100001809 92470204 Initiative Scientific Research Program, Institute of Zoology, Chinese Academy of Sciences 2023IOZ0102 2024IOZ0101 pmc-status-qastatus 0 pmc-status-live yes pmc-status-embargo no pmc-status-released yes pmc-prop-open-access yes pmc-prop-olf no pmc-prop-manuscript no pmc-prop-legally-suppressed no pmc-prop-has-pdf yes pmc-prop-has-supplement yes pmc-prop-pdf-only no pmc-prop-suppress-copyright no pmc-prop-is-real-version no pmc-prop-is-scanned-article no pmc-prop-preprint no pmc-prop-in-epmc yes INTRODUCTION Investigating the regulatory mechanisms between genes enhances our understanding of biological processes and plays a pivotal role in interpreting cellular functions, treating diseases and promoting biotechnological innovations. Due to the intricate nature of biological networks, compounded by the prohibitive cost of wet-lab experiments, researchers urgently require efficacious computational simulation methods to help decipher gene regulatory mechanisms. Deep learning, at the forefront of artificial intelligence, has emerged as a research hotspot in recent years, thanks to its powerful fitting and predictive capabilities. However, its data-driven essence often constrains its utility in scenarios with limited data. The ‘pre-train and fine-tune’ paradigm [ 1–4 5 Recent advancements have pioneered foundation models in the single-cell domain. scBERT [ 6 2 7 8 9 10 1 In this paper, we introduce Cell-GraphCompass (CGCompass), a graph-based, knowledge-guided foundation model pre-trained on large-scale single-cell sequencing data. CGCompass conceptualizes each cell as a graph, with nodes representing the genes it contains and edges denoting the relationships between them. We employ a graph neural network [ 11 12 13 14 in silico RESULTS The graph-based foundation model overview CGCompass is a single-cell foundation model based on GNN and transformer architecture. We incorporate various biological features and previously summarized knowledge to provide the model with prior information. We collected over 50 million human single-cell sequencing data for pre-training, equipping CGCompass with general knowledge and generalization capability. The CGCompass model architecture consists of four components (Fig. 1 Figure 1. Overview of CGCompass methodology. (a) Model architecture: CGCompass consists of four components: an encoder, a GNN, a transformer and a decoder module. (b) Biological features used to build the cell graph: CGCompass utilizes gene names, gene transcription expression values, and gene text descriptions as node features and constructs edges based on TF–TG interactions, gene co-expression relationships, and positional relationship of genes on chromosome. (c) Pre-training stage: CGCompass learns general knowledge about genes through masked training on scCompass-h50M. (d) Downstream applications: CGCompass reaches state-of-the-art outcomes in a plethora of downstream tasks, exemplified by four instances in this paper: batch integration; cell type annotation; single-cell gene perturbation prediction; and bulk knockout prediction. To construct the cell graph, we used six types of feature data to describe genes and their interactions from different aspects (Fig. 1 15 16 After building the model and input cell graph, we conducted large-scale pre-training and various downstream tasks for CGCompass. For pre-training, we utilized approximately 50 million human single-cell transcriptomes from scCompass-h50M and designed a unified data processing workflow. Our pre-training strategy randomly masks 40% of gene expression values for each input and uses the remaining 60% to infer the overall cellular state and predict the expression of the masked genes (Fig. 1 in silico 1 Through pre-training, CGCompass acquires biologically meaningful knowledge After pre-training on large-scale single-cell RNA sequencing data, CGCompass theoretically possesses the capability to understand the functions and characteristics of most genes and to develop a general understanding of gene interactions within single cells. To test whether CGCompass truly possesses this capability and can further transfer to specific problem scenarios without fine-tuning like large language models (LLMs), we evaluated its generalization ability in a zero-shot manner using tasks within different biological backgrounds. Following pre-training, the embeddings stored in the CGCompass vocabulary encapsulate the model's overall understanding of each gene (see Supplementary Methods), so we used them as the basis for all testing experiments in this session. To assess whether CGCompass can recognize specific genes, we selected six binary classification datasets describing gene functions or characteristics across various aspects, including gene dosage sensitivity, chromatin dynamics and network dynamics. We conducted comparative experiments with three other methods for generating general gene embeddings: gene2vec [ 17 15 2 Fig. S1 Tables S1 6 Figure 2. Pre-training endows CGCompass with biologically meaningful knowledge. By dissecting the latent space of the pre-trained model, we tested whether CGCompass can, to some extent, identify genes and the interaction between them. We extracted the gene embeddings from CGCompass vocabulary and used them for gene-level classification tasks and GGI prediction. (a) Results of six gene classification experiments. The x y Fig. S2 Next, we evaluated CGCompass's ability to understand gene relationships. We used eight datasets from the STRING [ 18 19 21 22 2 Fig. S1 Gene programs can also serve as a means to evaluate the quality of gene embeddings. We clustered genes based on their embeddings, with each cluster representing a potential gene program. We then analyzed the expression patterns of these gene programs in a human immune tissue dataset [ 23 2 Fig. S2 In summary, we extracted the embeddings of CGCompass's gene vocabulary and tested its performance in gene classification, gene interaction prediction and gene program extraction tasks. The experimental results show that the pre-training of CGCompass can, to some extent, acquire meaningful biological knowledge. However, the vocabulary embeddings do not involve cell context information. To test whether CGCompass can correctly capture context-aware information and use it to solve practical problems, the following four chapters will fine-tune CGCompass to solve specific downstream tasks. Integrating multi-batch single-cell sequencing data with CGCompass In real-world scenarios, single-cell RNA-seq datasets are often derived from different experimental instruments, sequencing platforms and analysis methods. These variations introduce technical noise [ 24 We first conducted fine-tuning experiments on a perirhinal cortex (PC) dataset [ 25 26 28 7 8 3 Fig. S3 3 Table S7 Figure 3. Integrating multiple batches of data with CGCompass. On the PC dataset, (a) UMAP plots of cell embeddings generated by fine-tuned CGCompass and other baseline models, colored by the ground truth cell types. (b) Quantitative metric results of fine-tuned CGCompass and other baseline models. The value range for all metrics is between 0 and 1, with higher values indicating better performance. (c) Quantitative metric results of different foundation models’ zero-shot performance. (d) UMAP plots of zero-shot embeddings from foundation models. Zero-shot inference represents a distinguishing capability of pre-trained foundation models. Since the model is pre-trained on a diverse set of cell types, it can generate reasonably accurate embeddings for new cells without the need for further fine-tuning. Therefore, we tested CGCompass's zero-shot performance on batch integration tasks against the three leading foundation models [ 7 9 3 Table S8 To demonstrate the effectiveness of graph-structured pre-training, we conducted ablation experiments on both the graph structure and the pre-training process. For fair comparison, we first ablated the graph structure and pre-trained a single transformer-based model on scCompass-h50M, then fine-tuned it on the PC dataset using the same loss function. Results ( Table S9 Table S10 We conducted similar fine-tuning and zero-shot experiments on three additional datasets. The PBMC 10k dataset [ 29 30 23 Figs. S4 S6 Tables S11 S20 CGCompass exhibits commendable performance in cell type annotation After evaluating the performance of CGCompass in batch integration, we proceeded to test its ability for cell type annotation. We provided the model with a reference set to guide it in learning the mapping from RNA-seq inputs to cell type labels, then supplied a separate query set to test the model's annotation performance (Fig. 4 Figure 4. CGCompass boosts cell type annotation. (a) Schematic of the cell type annotation task. On the MS dataset, (b) UMAP visualization of cell embeddings generated by CGCompass, colored by ground truth cell types (left) and CGCompass prediction results (right). (c) Quantitative evaluation of cell annotation by CGCompass and baseline models, with fine-tuning results on the left, and zero-shot results on the right. (d) Confusion matrix between cell types predicted by fine-tuned CGCompass and ground truth labels, with normalization on the left and absolute values on the right. (e) Ablation study on the GNN module and pre-training stage of CGCompass. We first conducted experiments on a multiple sclerosis (MS) dataset [ 31 32 33 6 8 4 4 Table S21 4 4 Tables S22 23 Next, we investigated CGCompass's zero-shot annotation capability using a linear probe approach. For each cell in both the reference and query sets, we used CGCompass to generate cell embeddings. A linear model was then trained on the reference embeddings to predict cell types, with its performance evaluated on the query set. The same procedure was applied to test Geneformer and scGPT. As shown in the experimental results (Fig. 4 Table S24 We further validated CGCompass on three additional public datasets. The myeloid (Mye) [ 34 Fig. S7 Tables S25 S28 35 36 Fig. S8 Tables S29 32 19 Tables S33 S34 CGCompass excels at predicting single-cell gene perturbation response After exploring cell-level downstream tasks, we now turn our attention to assessing the performance of CGCompass in gene-level application scenarios. Precise prediction of gene perturbation response is crucial for understanding the regulatory patterns among genes. The advancement of gene editing [ 37 38 39 41 42 Our empirical evaluation began with a public dataset named Norman [ 43 mse corr corr_delta _all _de 5 5 5 Figure 5. CGCompass predicts single-cell gene perturbation responses accurately. (a) Quantitative comparison of the perturbation predictions between CGCompass and baseline models at single-cell resolution, with lower mse corr x y y x x To mitigate the impact of CRISPR [ 37 5 Fig. S9 5 Fig. S10 The above pseudo-bulk results were aggregated from single-cell predictions. We then tested a direct pseudo-bulk input setting, where the model was fed average expression profiles directly. Both scGPT and CGCompass showed notable performance gains ( Table S36 Fig. S11 We further validated our findings on two additional single-gene perturbation datasets. The Adamson [ 44 38 Tables S35 36 Fig. S11 Given that different foundation models adopt distinct model architectures and pre-training datasets, we compared Geneformer, scGPT and CGCompass using the same pre-training dataset. We randomly sampled 10% of the data from scCompass-h50M, denoted as scCompass-h5M, and re-trained the three models on this subset. Their fine-tuning performance was then evaluated across three downstream tasks: batch integration; cell type annotation; and single-cell gene perturbation prediction. Using the same pre-training dataset, CGCompass consistently outperformed the other models, underscoring the advantages of the CGCompass architecture ( Tables S37 41 To better understand the contribution of each biological feature to CGCompass, we separately performed ablation of the four features, excluding gene names and gene expression. After each ablation, CGCompass was re-trained on scCompass-h5M, and fine-tuning experiments were conducted across three downstream tasks. The results indicated that the ablation of each feature negatively impacted model performance, demonstrating that each feature contributes to the model ( Tables S42 S45 Exploring bulk gene knockout prediction with CGCompass After completing the single-cell perturbation study, we extended our exploration to the bulk level. Single-cell gene perturbation focuses on the impact of perturbing certain genes on individual cells, whereas bulk gene perturbation emphasizes the effects on cell populations, which is significant for research in areas such as organ development and tissue regeneration. Our methodology employed a two-step transfer strategy. First, we pre-trained CGCompass on 20 million mouse single-cell sequencing data. This was followed by a second pre-training phase on 300 000 mouse bulk sequencing data, enabling the transition from a single-cell foundation model to a bulk-level model. Next, we fine-tuned the model on a dataset of over 3300 mouse bulk gene knockouts to adapt the bulk foundation model into a bulk knockout model (Supplementary Methods). We aimed to predict the direction of change for all genes following knockout—categorizing them into three classes: 2-fold upregulation; no change; and 2-fold downregulation. Given the severe class imbalance in the knockout dataset, where upregulated or downregulated genes account for only about 4%, we designed a two-step classifier as the decoder to prioritize the detection of upregulated and downregulated genes (Fig. 6 6 6 6 Figure 6. Exploring bulk gene knockout prediction with CGCompass. (a) Knockout model architecture. We designed a ‘two-step’ classifier as the decoder module of CGCompass for the bulk knockout problem scenario. For each gene's embedding, CGCompass first determines whether its expression value changes, then judges whether it is up or down. (b) Distribution of perturbation conditions in the bulk knockout dataset we collected. ‘Single’ represents single-gene knockout, and ‘ComboX’ represents knockout of X genes. (c) In the three-class (up, no change, down) task, classification results of different models. (d) Confusion matrix for CGCompass. (e) Ablation experiment on different pre-training stages. (f) In the five-class (5-fold up, 2-fold up, no change, 2-fold down, 5-fold down) task, classification results of different models. (g) Ablation experiment on different pre-training stages. Furthermore, to validate the effectiveness of the two-step transfer process, we conducted ablation experiments on both the single-cell pre-training phase and the bulk-level pre-training phase separately. The results (Fig. 6 Finally, we refined the granularity of direction prediction, attempting to predict whether a gene is 5-fold upregulated, 2-fold upregulated, unchanged, 2-fold downregulated or 5-fold downregulated. With more specific supervisory signals, CGCompass demonstrated a more significant improvement compared with the three-class classification (Fig. 6 Fig. S10 6 DISCUSSION In this article, we introduce Cell-GraphCompass, the pioneering single-cell foundation model utilizing graph structures to model genes and cells. Various biological features and prior knowledge were embedded through graph neural networks. The results from zero-shot inference, evaluated at both the gene level and the cell level, confirm that our pre-training successfully captured an understanding of genes and their interactions to a certain extent. The model, after fine-tuning, was used for a diverse range of downstream tasks, achieving a satisfactory level of performance. Batch integration experiments demonstrate CGCompass's effectiveness in overcoming batch effects, while cell type annotation tasks further validate CGCompass's applicability to cell-level problems. Furthermore, we delved into gene perturbation response prediction, where CGCompass improved predictions for single-cell gene perturbations and pioneeringly explored bulk gene knockout prediction, showcasing its potential for practical applications. Through abundant comparative and ablation studies, we demonstrated the efficacy of the CGCompass methodology. Comparisons with smaller models trained from scratch, along with ablation studies on the pre-training stage, underscored the effectiveness of pre-training operations. Evaluating against other foundation models and ablation of the GNN module confirmed our approach of cell graph modeling. Graph pre-training allows the model to be exposed to various types of cells and associated biological features before being applied to downstream tasks. This accelerates the model's convergence in specific application scenarios and effectively prevents it from converging to local optima. Consequently, it becomes feasible to apply deep learning in many data-sparse situations and alleviates the misleading tendencies caused by biased data. At the same time, we also recognize that there are still many areas where the model can be improved. The information provided by transcriptomics alone is limited. In the future, a comprehensive multi-omics integrated model could be considered, incorporating data from ATAC-seq, proteomics, epigenomics and other sources. Moreover, with the rapid advancement of LLMs, exploring more advanced LLMs beyond BioBERT for extracting textual information from gene descriptions is promising. GenePT [ 45 46 47 48 40 42 As foundation models garner increasing attention in the life sciences, some researchers have raised concerns regarding their ability to truly advance scientific discovery in this field [ 49 50 Moreover, the effectiveness of a foundation model often depends on how it is applied. Recently, we noted that some studies have discussed whether linear models or foundation models are better suited for perturbation prediction [ 49 As the ‘pre-training and fine-tuning’ paradigm continues to advance in biology, graph-based foundation models like CGCompass are expected to play an important role by integrating rich biological priors into model training. We also envision these models enabling new directions in areas such as cell fate reprogramming, cancer drug development and organoid culture. METHODS Constructing cell graphs using biological features CGCompass abstracts each cell as a topological graph \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym}\n\\usepackage{amsfonts}\n\\usepackage{amssymb}\n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n$G = ( {\\mathcal{V},\\mathcal{E},{\\boldsymbol{X}},{\\boldsymbol{\\ E}}} )$\\end{document} \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym}\n\\usepackage{amsfonts}\n\\usepackage{amssymb}\n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n$\\mathcal{V}$\\end{document} \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym}\n\\usepackage{amsfonts}\n\\usepackage{amssymb}\n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n${\\boldsymbol{X}}$\\end{document} \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym}\n\\usepackage{amsfonts}\n\\usepackage{amssymb}\n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n$\\mathcal{E}$\\end{document} \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym}\n\\usepackage{amsfonts}\n\\usepackage{amssymb}\n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n${\\boldsymbol{E}}$\\end{document} Methods S1 Assembling and pre-processing pre-training corpus To support foundation model research, we have constructed a large-scale single-cell transcriptome corpus, scCompass-h50M [ 10 14 The pre-processing of CGCompass's pre-training data involves normalization, log-transformation, highly variable gene extraction, value binning, tokenization and padding. First, the sequencing counts of all genes within a cell are normalized (with the total sum controlled to 10 000) and log-transformed. Next, the Seurat For the remaining four biological features, we have compiled a comprehensive knowledge base containing information on all genes and gene pairs. Relevant information for the 1200 selected genes is extracted from this knowledge base to form the additional feature inputs for the cell graphs. The knowledge base includes a total of 44 858 types of nodes, 1247 285 types of TF–TG interactions, 2170 758 types of chromatin position relationships, and gene co-expression relationships with a threshold set at 0.6 (i.e. gene pairs with a correlation coefficient greater than 0.6 are connected by an edge). Model architecture The CGCompass model consists of three GNN layers and 12 transformer encoder layers, each with 8 attention heads. The hidden dimension of the model is set to 512. Detailed information on the model architecture and forward propagation equations is provided in Methods S2 The specifics of CGCompass's pre-training and downstream tasks are described in Methods S3 S4 Methods S5 Supplementary Material nwaf255_Supplemental_Files ACKNOWLEDGEMENTS We would like to thank iFLYTEK for their support in the experiments. Our gratitude goes to Beijing Super Cloud Computing Center for their assistance with machine management and technical support. We also appreciate the data support provided by the Computer Network Information Center, Chinese Academy of Sciences. Special thanks to Li Li from iFLYTEK for his guidance on the code, and to Xusheng Ma from the Institute of Zoology for her help with data organization. CODE, DATA AND MATERIALS AVAILABILITY The code for CGCompass is now open-sourced at GitHub: https://github.com/epang-ucas/Cell-Graph-Compass https://zenodo.org/records/14650474 FUNDING This work was supported by the Pilot Project for the National Key Research and Development Program (2024YFF0729200), the CAS Project for Young Scientists in Basic Research (YSBR-076), the Pilot Project for Enhancing Original Innovation Capability of the Chinese Academy of Sciences (E129L111), the Informatization Plan of the Chinese Academy of Sciences (CAS-WX2021SF-0101), the Strategic Priority Research Program of the Chinese Academy of Sciences (XDB38030300), the National Natural Science Foundation of China (92470204) and the Initiative Scientific Research Program, Institute of Zoology, Chinese Academy of Sciences (2023IOZ0102, 2024IOZ0101). AUTHOR CONTRIBUTIONS X.L., G.F., L.C., Y.Z., Z.M., G.H., J.P. and P.W. supervised the project. X.L., G.F., L.C., J.P., C.F. and Z.H. conceived and designed the study. L.C., C.F., W.C. and Z.H. developed the algorithm and conducted the experiments. C.F., Z.H. and S.L.C. collected and encoded the biological features. C.F., Z.H., W.L., S.B.C. and C.L. conducted the comparison of different methods for downstream tasks. W.L., W.C., Z.H., Q.L. and Y.L. collected and processed the pre-training data. X.L., G.F., L.C. and C.F. wrote the manuscript. All authors reviewed and approved the final manuscript.   Conflict of interest statement. REFERENCES 1. Vaswani A Shazeer N Parmar N et al. Attention is all you need 31st Conference on Neural Information Processing Systems (NIPS 2017), Long Beach, CA, USA, 4–9 December 2017 2. Devlin J Chang M-W Lee K et al. BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding Proceedings of the North American Chapter of the Association for Computational Linguistics 2019 4171 86 Association for Computational Linguistics Minneapolis, MI, USA 3. Radford A Narasimhan K Salimans T et al. Improving language understanding by generative pre-training OpenAI 2018 4. Fang C Wang Y Song Y et al. How do large language models understand genes and cells ACM Trans Intell Syst and Technol 2024 5. Wang Y Yu Z Yao W et al. PandaLM: an automatic evaluation benchmark for LLM instruction tuning optimization The Twelfth International Conference on Learning Representations (ICLR 2024), Vienna, Austria, 7 May 2024 6. Yang F Wang W Wang F et al. scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data Nat Mach Intell 2022 4 852 66 10.1038/s42256-022-00534-z 7. Theodoris CV Xiao L Chopra A et al. Transfer learning enables predictions in network biology Nature 2023 618 616 24 10.1038/s41586-023-06139-9 37258680 PMC10949956 8. Cui H Wang C Maan H et al. scGPT: toward building a foundation model for single-cell multi-omics using generative AI Nat Methods 2024 21 1470 80 10.1038/s41592-024-02201-0 38409223 9. Hao M Gong J Zeng X et al. Large-scale foundation model on single-cell transcriptomics Nat Methods 2024 21 1481 91 10.1038/s41592-024-02305-7 38844628 10. Yang X Liu G Feng G et al. GeneCompass: deciphering universal gene regulatory mechanisms with a knowledge-informed cross-species foundation model Cell Res 2024 34 830 45 10.1038/s41422-024-01034-y 39375485 PMC11615217 11. Siameh T Semi-supervised classification with graph convolutional networks Technical Report. 2023 12. Ju W Fang Z Gu Y et al. A comprehensive survey on deep graph representation learning Neural Netw 2024 173 106207 10.1016/j.neunet.2024.106207 38442651 13. Long Q Jin Y Song G et al. Graph structural-topic neural network Proceedings of the 26th ACM SIGKDD International Conference On Knowledge Discovery & Data Mining 1065–73 Association for Computing Machinery Virtual Event, CA, USA 6–10 July 2020 14. Wang P Liu W Wang J et al. scCompass: an integrated cross-species scRNA-seq database for AI-ready bioRxiv 10.1002/advs.202500870 PMC12224968 40317650 15. Lee J Yoon W Kim S et al. BioBERT: a pre-trained biomedical language representation model for biomedical text mining Bioinformatics 2020 36 1234 40 10.1093/bioinformatics/btz682 31501885 PMC7703786 16. Brown GR Hem V Katz KS et al. Gene: a gene-centered information resource at NCBI Nucleic Acids Res 2015 43 D36 42 10.1093/nar/gku1055 25355515 PMC4383897 17. Du J Jia P Dai Y et al. Gene2vec: distributed representation of genes based on co-expression BMC Genomics 2019 20 82 10.1186/s12864-018-5370-x 30712510 PMC6360648 18. Szklarczyk D Gable AL Lyon D et al. STRING v11: protein–protein association networks with increased coverage, supporting functional discovery in genome-wide experimental datasets Nucleic Acids Res 2019 47 D607 13 10.1093/nar/gky1131 30476243 PMC6323986 19. Abascal F Acosta R Addleman NJ et al. Expanded encyclopaedias of DNA elements in the human and mouse genomes Nature 2020 583 699 710 10.1038/s41586-020-2493-4 32728249 PMC7410828 20. Oki S Ohta T Shioi G et al. ChIP-Atlas: a data-mining suite powered by full integration of public ChIP-seq data EMBO Rep 2018 19 e46255 10.15252/embr.201846255 30413482 PMC6280645 21. Xu H Baroukh C Dannenfelser R et al. ESCAPE: database for integrating high-content published data collected from human and mouse embryonic stem cells Database 2013 2013 bat045 10.1093/database/bat045 23794736 PMC3689438 22. Shu H Zhou J Lian Q et al. Modeling gene regulatory networks using neural network architectures Nat Comput Sci 2021 1 491 501 10.1038/s43588-021-00099-8 38217125 23. Luecken MD Büttner M Chaichoompu K et al. Benchmarking atlas-level data integration in single-cell genomics Nat Methods 2022 19 41 50 10.1038/s41592-021-01336-8 34949812 PMC8748196 24. Chen C Grennan K Badner J et al. Removing batch effects in analysis of expression microarray data: an evaluation of six batch adjustment methods PLoS One 2011 6 e17238 10.1371/journal.pone.0017238 21386892 PMC3046121 25. Siletti K Hodge R Mossi Albiach A et al. Transcriptomic diversity of cell types across the adult human brain Science 2023 382 eadd7046 10.1126/science.add7046 37824663 26. Lopez R Regier J Cole MB et al. Deep generative modeling for single-cell transcriptomics Nat Methods 2018 15 1053 8 10.1038/s41592-018-0229-2 30504886 PMC6289068 27. Tian T Wan J Song Q et al. Clustering single-cell RNA-seq data with a model-based deep learning approach Nat Mach Intell 2019 1 191 8 10.1038/s42256-019-0037-0 28. Hao Y Hao S Andersen-Nissen E et al. Integrated analysis of multimodal single-cell data Cell 2021 184 3573 87 10.1016/j.cell.2021.04.048 34062119 PMC8238499 29. Gayoso A Lopez R Xing G et al. A Python library for probabilistic analysis of single-cell omics data Nat Biotechnol 2022 40 163 6 10.1038/s41587-021-01206-w 35132262 30. Lotfollahi M Naghipourfar M Luecken MD et al. Mapping single-cell data to reference atlases by transfer learning Nat Biotechnol 2022 40 121 30 10.1038/s41587-021-01001-7 34462589 PMC8763644 31. Schirmer L Velmeshev D Holmqvist S et al. Neuronal vulnerability and multilineage diversity in multiple sclerosis Nature 2019 573 75 82 10.1038/s41586-019-1404-z 31316211 PMC6731122 32. Xu C Lopez R Mehlman E et al. Probabilistic harmonization and annotation of single-cell transcriptomics data with deep generative models Mol Syst Biol 2021 17 e9620 10.15252/msb.20209620 33491336 PMC7829634 33. Chen J Xu H Tao W et al. Transformer for one stop interpretable cell type annotation Nat Commun 2023 14 223 10.1038/s41467-023-35923-4 36641532 PMC9840170 34. Cheng S Li Z Gao R et al. A pan-cancer single-cell transcriptional atlas of tumor infiltrating myeloid cells Cell 2021 184 792 809.e23 10.1016/j.cell.2021.01.010 33545035 35. Baron M Veres A Wolock SL et al. A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure Cell Syst 2016 3 346 60 10.1016/j.cels.2016.08.011 27667365 PMC5228327 36. Muraro MJ Dharmadhikari G Grün D et al. A single-cell transcriptome atlas of the human pancreas Cell Syst 2016 3 385 94 10.1016/j.cels.2016.09.002 27693023 PMC5092539 37. Doudna JA Charpentier E The new frontier of genome engineering with CRISPR-Cas9 Science 2014 346 1258096 10.1126/science.1258096 25430774 38. Dixit A Parnas O Li B et al. Perturb-Seq: dissecting molecular circuits with scalable single-cell RNA profiling of pooled genetic screens Cell 2016 167 1853 66 10.1016/j.cell.2016.11.038 27984732 PMC5181115 39. Gao Y Wei Z Dong K et al. Toward subtask-decomposition-based learning and benchmarking for predicting genetic perturbation outcomes and beyond Nat Comput Sci 2024 4 773 85 10.1038/s43588-024-00698-1 39333790 40. Yang Y Li G Zhong Y et al. Gene knockout inference with variational graph autoencoder learning single-cell gene regulatory networks Nucleic Acids Res 2023 51 6578 92 10.1093/nar/gkad450 37246643 PMC10359630 41. Zhang R Meng-Papaxanthos L Vert J-P et al. Semi-supervised single-cell cross-modality translation using Polarbear 26th Annual International Conference, RECOMB 2022, San Diego, CA, USA, 22–25 May 2022 42. Roohani Y Huang K Leskovec J Predicting transcriptional outcomes of novel multigene perturbations with GEARS Nat Biotechnol 2024 42 927 35 10.1038/s41587-023-01905-6 37592036 PMC11180609 43. Norman TM Horlbeck MA Replogle JM et al. Exploring genetic interaction manifolds constructed from rich single-cell phenotypes Science 2019 365 786 93 10.1126/science.aax4438 31395745 PMC6746554 44. Adamson B Norman TM Jost M et al. A multiplexed single-cell CRISPR screening platform enables systematic dissection of the unfolded protein response Cell 2016 167 1867 82 10.1016/j.cell.2016.11.048 27984733 PMC5315571 45. Chen Y Zou J Simple and effective embedding model for single-cell biology built from ChatGPT Nat Biomed Eng 2025 9 483 93 10.1038/s41551-024-01284-6 39643729 46. Istrate A-M Li D Karaletsos T scGenePT: is language all you need for modeling single-cell perturbations? 47. Yang X Song Z King I et al. A survey on deep semi-supervised learning IEEE Trans Knowl Data Eng 2023 35 8934 54 10.1109/TKDE.2022.3220219 48. Wang Y-X Ramanan D Hebert M Learning to model the tail Proceedings of the 31st International Conference on Neural Information Processing Systems 2017 7032 42 49. Ahlmann-Eltze C Huber W Anders S Deep learning-based predictions of gene perturbation effects do not yet outperform simple linear methods 10.1038/s41592-025-02772-6 PMC12328236 40759747 50. Kedzierska KZ Crawford L Amini AP et al. Assessing the limits of zero-shot foundation models in single-cell biology ",
  "metadata": {
    "Title of this paper": "Assessing the limits of zero-shot foundation models in single-cell biology",
    "Journal it was published in:": "National Science Review",
    "URL": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC12485608/"
  }
}