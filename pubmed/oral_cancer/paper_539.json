{
  "title": "Paper_539",
  "abstract": "pmc Bioinformatics Bioinformatics 716 bioinfo bioinformatics Bioinformatics 1367-4803 1367-4811 Oxford University Press PMC12478697 PMC12478697.1 12478697 12478697 40905951 10.1093/bioinformatics/btaf482 btaf482 1 Original Paper Systems Biology AcademicSubjects/SCI01060 Discovering subnetworks in SBML models https://orcid.org/0000-0003-0802-4069 Hellerstein Joseph L PhD Conceptualization Data curation Formal analysis Investigation Methodology Project administration Software Visualization Writing - original draft Writing - review & editing  eScience Institute, University of Washington United States  Paul G. Allen School of Computer Science, University of Washington United States  Department of Bioengineering, University of Washington United States Smith Lucian P PhD Data curation Methodology  Paul G. Allen School of Computer Science, University of Washington United States Tatka Lillian T PhD Data curation  Talus Bioscience United States https://orcid.org/0000-0002-4576-8107 Andrews Steven S PhD Conceptualization  Department of Bioengineering, University of Washington United States Kochen Michael A PhD Data curation  Software Applications and Technology, Rocky Mountain Division, Applied Research Associates, Inc United States https://orcid.org/0000-0002-3659-6817 Sauro Herbert M PhD Conceptualization Data curation Writing - review & editing  eScience Institute, University of Washington United States  Department of Bioengineering, University of Washington United States Martelli Pier Luigi Associate Editor Corresponding author. eScience Institute, University of Washington, Seattle, Washington, 98195, United States. E-mail: jlheller@uw.edu 9 2025 04 9 2025 41 9 495993 btaf482 16 5 2025 04 8 2025 25 8 2025 28 8 2025 29 9 2025 04 09 2025 30 09 2025 30 09 2025 © The Author(s) 2025. Published by Oxford University Press. 2025 https://creativecommons.org/licenses/by/4.0/ This is an Open Access article distributed under the terms of the Creative Commons Attribution License ( https://creativecommons.org/licenses/by/4.0/ Abstract Motivation Many advances in biomedical research are driven by structural analysis, which investigates interconnections between elements in biological systems (e.g. structural analysis of proteins to infer their function). Herein, we consider subnet discovery in chemical reaction networks (CRNs)–discovering a subset of a target CRN, i.e. structurally identical to a reference CRN. Structural analysis techniques such as motif finding and graph mining look for small, arbitrary, and commonly occurring substructures (e.g. three gene feedforward loops). In contrast, subnet discovery looks for larger, specific, and infrequently occurring substructures (e.g. 10 reactions mitogen-activated protein kinase (MAPK) pathway). Results We introduce pySubnetSB pySubnetSB 10 78 10 8 Availability and implenetation  pySubnetSB pip install pySubnetSB https://github.com/ModelEngineering/pySubnetSB/ eScience Institute at the University of Washington NIBIB 10.13039/100000070 National Institutes of Health 10.13039/100000002 NIH 10.13039/100000002 P41EB023912 pmc-status-qastatus 0 pmc-status-live yes pmc-status-embargo no pmc-status-released yes pmc-prop-open-access yes pmc-prop-olf no pmc-prop-manuscript no pmc-prop-legally-suppressed no pmc-prop-has-pdf yes pmc-prop-has-supplement no pmc-prop-pdf-only no pmc-prop-suppress-copyright no pmc-prop-is-real-version no pmc-prop-is-scanned-article no pmc-prop-preprint no pmc-prop-in-epmc yes 1 Introduction Many insights in biomedical research are driven by structural analysis, which investigates the interconnections between elements in biological systems. Examples include: structural analysis of proteins to infer their function (e.g. Osadchy and Kolodny 2011 Paul et al. Hartwell et al. Alon 2007 Sharan and Ideker 2006 McGinnis and Madden 2004 Lambusch et al. Shellman et al. Our focus is on CRNs in biological systems. In particular, we develop a tool for discovering subnetworks (hereafter just subnets) in CRNs. By subnet discovery, we mean determining if a reference CRN is structurally identical to a subnet of a target CRN in that there is an equivalence between the reference reactions and chemical species and the reactions and species in a subnet of the target. At first glance, subnet discovery seems to overlap with motif finding and graph mining, techniques that look for small, arbitrary, and commonly occurring substructures (e.g. three gene feedforward loops ( Alon 2007 We believe that subnet discovery is of particular interest for the following use cases. Use case 1: Infer function in the target from the reference. If a reference CRN is a subnet of a target CRN, then the functions provided by the reference (e.g. oscillation) might be present in the target. Use case 2: Infer conserved mechanisms in targets that have the same reference. If many target CRNs have the same reference as a subnet, then the reference might Section 4 provides examples of both use cases. We emphasize that like motif finding and graph mining, the objective of subnet discovery is to identify interesting hypotheses. In general, additional work is required beyond the discovery of the subnet to obtain a research result. To illustrate subnet discovery, consider Fig. 1 Li et al. Figure 1. Two models in BioModels. The running example uses Model 1034 (a) as the reference network and Model 351 (b) as the target network. Although these CRNs address very different biological functions, it turns out that Model 1034 is structurally identical to a subnet of Model 351. This subnet is specified by: (a) a species mapping Fig. 2b reaction mapping Fig. 2a mapping pair Fig. 2 inferred subnet Fig. 2c structurally identical subnet (sis) mapping pair J1 v02 Figure 2. Mapping pairs and inferred subnet. The reaction mapping in (a) in combination with the species mapping in (b) is a mapping pair that identifies the inferred subnet of Model 351 in (c) that is structurally identical to Model 1034. The foregoing is an example of strong identity reactant stoichiometry matrix product stoichiometry matrix 2 A → A + B ( 1 1 ) , ( 2 0 ) , standard stoichiometry ( − 1 1 ) There is also weak identity Sauro 2014 Discovering subnets in CRNs is an instance of the subgraph isomorphism problem in graph theory. It is well known that this problem is NP-hard ( Hartmanis 1982 In the worst case, we must make matrix comparisons for all M ⋆ R T r s M M r R (1) M ⋆ = ( M r T M r R ) M r R ! ( M s T M s R ) M s R ! The magnitude of M ⋆ M ⋆ ≈ 10 78 10 80 There are well more than 100 subgraph algorithms (e.g. Conte et al. Milano et al. Special considerations are required to find subgraphs in CRNs. To elaborate, note that the vast majority of existing subgraph algorithms (e.g. McCreesh et al. Cordella et al. simple R : A → C R ′ : A ′ + B ′ → C ′ A = { ( A , R ) , ( R , C ) } A ′ = { ( A ′ , R ′ ) , ( B ′ , R ′ ) , ( R ′ , C ′ ) } R R ′ R ′ R A ⊂ A ′ representing CRNs as simple graphs often finds subnets in the target that have a different structure from the reference This problem can be avoided by representing CRNs as hypergraphs (e.g. Yang et al. Fig. 3a J5 similar Sharan and Ideker 2006 Zhang et al. Milano et al. Figure 3. Bipartite graph (a) and reaction monopartite (b) graphs for Model 1034. Squares indicate reactions, and circles indicate species. Text above squares indicate the reaction type (e.g. 01 is 0 reactant, 1 product). The reaction monopartite graph is inferred from the bipartite graph. To our knowledge, only Yang et al. constraint-based approach Yang et al. Yang et al. This article introduces pySubnetSB Hucka et al. pySubnetSB 10 78 10 8 pySubnetSB 2 Materials and methods  pySubnetSB 2.1 Constraint-based subnet discovery  Figure 4 Figure 4. High-level algorithm for subnet discovery. Data are indicated by regular rectangles. Program logic is indicated by rounded rectangles and annotated with shaded numbers to indicate the sequence of steps. The high-level program logic in Fig. 4 Yang et al. 2.2 Generating random CRNs Our choice of constraints and the way in which we evaluate our algorithms are based on a statistical characterization of CRNs in the BioModels repository ( Xu 2023 reaction type ( 1 , 2 ) A → B + C Xu (2023) pySubnetSB NetworkBase.makeRandomNetworkByReactionType network_base The evaluation of subnet discovery requires generating reference–target pairs, where the reference is randomly embedded in the target. Our approach is implemented in the network_base NetworkBase.RandomReferenceAndTarget M s R M r R M s T M r T M r T − M r R M s T M r R M s R 3 Results Here, we discuss the CRN-specific constraints that we employ (Section 3.1), their effectiveness in reducing computational complexity (Section 3.2), how we use vectorization and process-based parallelism and the speedups achieved (Section 3.3), and our approach to evaluating the statistical significance of subnet discovery (Section 3.4). Section 3.5 provides details of the package pySubnetSB 3.1 Constraints for CRNs  pySubnetSB 3.1.1 Reaction constraints and reaction mappings Let r R r T ( r R , r T ) r R r T Our first reaction constraint, RC1, is that r T r R r R = J5 Fig. 1b R T = v01 ( 2 , 1 ) The remaining constraints make use of the reaction monopartite graph, a graph in which all nodes are reactions. This graph is constructed from the full CRN bipartite hypergraph by placing an arc from a source reaction to a destination reaction if the source has a product species, i.e. a reactant for the destination. Figure 3 Reaction constraints RC2 and RC3 use information about predecessors and successors in the reaction monopartite graph. Consider the arc from reaction J 1 J 5 Fig. 3b J 1 J 5 J 5 J 1 The reaction constraints are the following. RC1: r R r T RC2: The count of 1-step and 2-step predecessor r R r T RC3: The count of 1-step and 2-step successor r R r T Each CRN has a reaction and a species constraint matrix Fig. 4 Fig. 4 Figure 5a and b Figure 5. Illustration of calculating reaction mappings. (a and b) Partial data for reaction constraint matrices (reaction type, 1-step successor counts). (c) The reaction compatibility calculated from (a) and (b). (d) Three reaction mappings (the columns) of the many reaction mappings; the reaction mappings are based on (c) and are obtained by selecting a unique 351 reaction in the list of compatible reactions for each 1034 reaction. The construction of the reaction mappings involves building the reaction compatibility vector i i i Figure 5c Fig. 5a and b Figure 5d Fig. 5c A reaction mapping is constructed by selecting one target reaction from each entry in the reaction compatibility vector without repeating a target reaction. Figure 5d 3.1.2 Species constraints and species mappings Species constraints are organized and implemented in a manner analogous to reaction constraints. There are species constraint matrices, species compatibility vectors, and species mappings obtained from species compatibility vectors. Species are based on the full CRN bipartite graph. Let s R s T s T s R SC1: The count of reactions (by type) in which s R reactant s T SC2: The count of reactions (by type) in which the s R product s T SC3: The count of reactions (by type) that can be reached by s R forward s T SC4: The count of reactions (by type) that can be reached by s R reverse s T 3.2 Effectiveness of constraints We quantify the effectiveness of reaction and species constraints by reducing reaction and species mappings. Our studies calculated the number of mappings for different combinations of constraints. For reactions, we considered the conditions: (i) no constraints (none), (ii) only RC1, (iii) only RC2 and RC3, and (iv) all constraints (RC1–RC3). For species, the conditions are: (i) no constraints, (ii) SC1–SC2, (iii) SC3–SC4, and (iv) SC1–SC4. Condition (i) (reactions and species) is calculated deterministically as in Eq. (1) Fig. 4 CompatibilityCollection.log10_num_assignment pySubnetSB compatibility_collection.py  Figure 6 l o g 10 10 40 10 80 10 3 10 5 10 8 10 70 Figure 6. Constraints reduce the number of mappings to be evaluated by over 10 30 l o g 10  Figure 7 l o g 10 absence Figure 7. Constraints reduce the number of mapping pairs to be evaluated when a reference network is present and even more when it is absent. Unparenthesized numbers are the integer part l o g 10 3.3 Computational speedups Constraints dramatically reduce the number of mapping pairs. However, even after constraints are applied, there may still be 10 10 10 13  pySubnetSB vectorization for pySubnetSB Fig. 4 Fig. 4 pySubnetSB m We conducted studies measuring the runtime for stacking m m ∈ { 1 , 10 , 100 , 1000 } T M ( m ) m S M ( m ) = T M ( 1 ) T M ( m ) S M ( 10 ) ≈ 9 , S M ( 100 ) ≈ 30 , S M ( 1000 ) ≈ 40 m > 1000  pySubnetSB multiprocessing Fig. 4 To assess the speedup for process parallelism, we conducted six studies with a different set of 10 random target CRNs (100 reactions, 100 species); each target CRN had an embedded reference CRN (five reactions, five species). These networks were generated using the method in Section 2.2. Then, subnet discovery was done using 1, 2, 4, 8, and 16 processors on a 128 GB Mac Studio M1 (with 20 cores). Let T P ( n ) n S P ( n ) = T P ( 1 ) T P ( n ) Figure 8 S P ( n ) = n Figure 8. Speedup from process parallelism. Markers indicate studies. Speedups are larger when there are more mapping pairs. Computational speedups are multiplicative. So, a speedup of 40 from vectorization and a speedup of 10 from process parallelism results in an overall speedup of 400. That is, a subnet discovery that would take 1 day on a single processor evaluating one mapping pair at a time will instead have an elapsed of 3.5 min on 15 processors that use vectorization of 1000 mapping pairs. 3.4 Statistical significance of subnet discovery Some CRNs are quite small. Since there are many more instances of small CRNs than larger ones, it is possible that the subnet discovery for a small CRN is not statistically significant. We assess statistical significance by answering the question “How likely is the reference CRN to occur by chance?” This depends on the number of reactions and species in the reference, which are denoted by ( M s R , M r R ) Step (1): generate K R ( M s R , M r R ) Step (2): generate K T ( M s R , M r R ) Step (3): for each reference CRN in step (1), count the number of target CRNs in step (2) that are strongly structurally identical, and report the fraction of occurrences of strong structural identity.   K R K R K R = 100 , K T = 1000  Figure 9 ( 2 , 2 ) ( 10 , 10 ) − l o g 10 Lindgren 1993 Fig. 9 Figure 9. Statistical significance of randomly chosen CRNs. Cells are annotated with − logp p 3.5 Python package  pySubnetSB Smith et al. pip install pySubnetSB The basic API consists of two functions. The first is findReferenceInTarget reference_model target_model max_num_mapping_pair max_num_mapping_pair findReferencesInTargets api_basics.ipynb https://github.com/ModelEngineering/pySubnetSB/blob/main/examples/ 4 Discussion This section studies the occurrence of subnets in the curated branch of BioModels, approximately 1000 models. (See data/README.md github max_num_mapping_pair 10 12 Figure 10 Figure 10. Summary of subnet discovery for curated BioModels. 4.1 Use Case 1: inferring function in targets Here, we consider Use Case 1 in the introduction, that the presence of the reference CRN in the target suggests that functions of the reference are in the target. The reference CRN is Model 10, which studies ultrasensitivity and negative feedback in a mitogen-activated protein kinase (MAPK) cascade. The model has 10 reactions and seven species. It turns out that this reference CRN is a subnet of several target models: (i) Model 146 (34 reactions), which investigates MAPK and Akt pathways in heregulin-induced ErbB signaling; (ii) Model 270 (42 reactions), which analyses isoform-specific ERK signaling and cell fate decisions; and (iii–iv) Models 466 (28 reactions) and 468 (74 reactions), which study shear-stress-induced nitric oxide production in endothelial cells. We have strong confirmation that the MAPK function is present in the targets since the paper associated with each model explicitly states that MAPK function is part of their model. We present another example of Use Case 1. This example lacks the strong confirmation provided in the first example, but it illustrate how subnet discovery can be used to generate interesting hypotheses. We ask the question “Are there models in BioModels that contain hidden oscillators?” We are aided in pursuing this question by the existence of a substantial database of generated oscillatory CRNs constructed as described in Tatka et al. Fig. 11 Helicobacter pylori Figure 11. An oscillating CRN, i.e. a subnet of several models in BioModels. 4.2 Use Case 2: inferring common mechanisms A common mechanism seems plausible if: (a) there are multiple targets that have an inferred network for the same reference; and (b) there is plausible explanation for why the targets might embed the same reference CRN. A potential common mechanism in our studies is Model 1059, which addresses the regulation of caspase-3 activation and degradation in apoptosis and has seven reactions and three species. The target models in BioModels that have an inferred subnet for 1059 are: Model 156 (oscillations and variability in the p53 system); Model 546 (early immune response and adaptive immune response kinetics in mice infected with influenza A virus); Model 789 (interaction between cancer cells and an oncolytic virus); Model 1012 (cell therapy in B-cell acute lymphoblastic leukemia); and Model 1048 (designing a cancer therapy). We note that all targets are related to intracellular immune response and/or cell death, and apoptosis is key to these processes. This gives us an interesting hypothesis about a common mechanism. 5 Conclusions and future work Subnet discovery is a powerful tool for generating hypotheses related to the presence of function and conserved mechanisms in CRNs. Subnet discovery is a kind of subgraph problem, and these problems are extremely demanding computationally. This article introduces pySubnetSB pySubnetSB 10 78 10 8 pySubnetSB 10 78 10 8 pySubnetSB In the near term, we want to increase the computational speed of pySubnetSB Acknowledgements Our deep appreciation to the reviewers for their thoughtful comments. We acknowledge support from the eScience Institute at the University of Washington, and NIBIB of the National Institutes of Health under grant number NIH P41EB023912. Author contributions Joseph Hellerstein (Conceptualization [lead], Data curation [equal], Formal analysis [lead], Investigation [lead], Methodology [lead], Project administration [lead], Software [lead], Visualization [lead], Writing—original draft [lead], Writing—review & editing [equal]), Lucian Smith (Data curation [equal], Methodology [supporting]), Lillian Taka (Data curation [equal]), Steven S. Andrews (Conceptualization [equal]), Michael Kochen (Data curation [equal]), and Herbert M. Sauro (Conceptualization [supporting], Data curation [equal], Writing—review & editing [equal]) Conflict of interest: None declared. Funding We acknowledge support from the eScience Institute at the University of Washington and NIBIB of the National Institutes of Health under grant number NIH P41EB023912. References Alon U. Network motifs: theory and experimental approaches Nat Rev Genet 2007 8 450 61 17510665 10.1038/nrg2102 Conte D Foggia P Sansone C et al Thirty years of graph matching in pattern recognition Int J Patt Recogn Artif Intell 2004 18 265 98 Cordella LP Foggia P Sansone C et al A (sub)graph isomorphism algorithm for matching large graphs IEEE Trans Pattern Anal Mach Intell 2004 26 1367 72 15641723 10.1109/TPAMI.2004.75 Hartmanis J. Computers and intractability: a guide to the theory of np-completeness (Michael R. Garey and David S. Johnson) SIAM Rev 1982 24 90 1 Hartwell LH Hopfield JJ Leibler S et al From molecular to modular cell biology Nature 1999 402 C47 52 10591225 10.1038/35011540 Hucka M Finney A Sauro HM et al SBML Forum The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models Bioinformatics 2003 19 524 31 12611808 10.1093/bioinformatics/btg015 Lambusch F Waltemath D Wolkenhauer O et al Identifying frequent patterns in biochemical reaction networks: a workflow Database 2018 2018 1 14 10.1093/database/bay051 PMC6030809 29992320 Li C Donizelli M Rodriguez N et al BioModels database: an enhanced, curated and annotated resource for published quantitative kinetic models BMC Syst Biol 2010 4 92 20587024 10.1186/1752-0509-4-92 PMC2909940 Lindgren B. Statistical Theory Taylor and Francis Group 1993 McCreesh C The glasgow subgraph solver: using constraint programming to tackle hard subgraph isomorphism problem variants Gadducci F Kehrer T McGinnis S Madden TL. BLAST: at the core of a powerful and diverse set of sequence analysis tools Nucleic Acids Res 2004 32 W20 5 15215342 10.1093/nar/gkh435 PMC441573 Milano M Agapito G Cannataro M et al Challenges and limitations of biological network analysis BioTech 2022 11 24 35892929 10.3390/biotech11030024 PMC9326688 Osadchy M Kolodny R. Maps of protein structure space reveal a fundamental relationship between protein structure and function Proc Natl Acad Sci USA 2011 108 12301 6 21737750 10.1073/pnas.1102727108 PMC3145735 Paul D Sanap G Shenoy S et al Artificial intelligence in drug discovery and development Drug Discov Today 2021 26 80 93 33099022 10.1016/j.drudis.2020.10.010 PMC7577280 Sauro H. Systems Biology: Introduction to Pathway Modeling Amazon 2014 Sharan R Ideker T. Modeling cellular machinery through biological network comparison Nat Biotechnol 2006 24 427 33 16601728 10.1038/nbt1196 Shellman ER Burant CF Schnell S et al Network motifs provide signatures that characterize metabolism Mol Biosyst 2013 9 352 60 23287894 10.1039/c2mb25346a PMC3619197 Smith LP Bergmann FT Chandran D et al Antimony: a modular model definition language Bioinformatics 2009 25 2452 4 19578039 10.1093/bioinformatics/btp401 PMC2735663 Tatka LT Luk W Elston TC et al Cesium: a public database of evolved oscillatory reaction networks Biosystems 2023 224 104836 36640942 10.1016/j.biosystems.2023.104836 PMC9997760 Xu J. SBMLKinetics: a tool for annotation-independent classification of reaction kinetics for SBML models BMC Bioinformatics 2023 24 248 37312031 10.1186/s12859-023-05380-3 PMC10262532 Yang Z, Zhang W, Lin X et al Zhang Z, Bu J, Ester M et al H2MN: graph similarity learning with hierarchical hypergraph matching networks Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery & Data Mining ACM 2021 2274 84 ",
  "metadata": {
    "Title of this paper": "SBMLKinetics: a tool for annotation-independent classification of reaction kinetics for SBML models",
    "Journal it was published in:": "Bioinformatics",
    "URL": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC12478697/"
  }
}